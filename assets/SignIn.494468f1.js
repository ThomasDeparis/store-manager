import{_ as y,r,c as g,w as O,H as f,I as h,J as R,j as i,aj as m,K as B,P as d,O as S,b6 as F,N as I,G as N,R as C,M as b}from"./index.a9029666.js";import{Q as A}from"./QForm.909eaf1f.js";import{u as P}from"./user-store.735d9c86.js";import{u as v}from"./vue-i18n.runtime.210c6e46.js";import{t as c}from"./index.fc676ab3.js";import{u as q}from"./notify-handler.4bb2df9b.js";const Q={name:"SignInputs",props:{signUpMode:{type:Boolean,default:!1}},emits:["onSignSuccessful","onSignFailed"],setup(e,a){const{t:o}=v(),t=r(null),l=r(null),n=r(null),s=e.signUpMode?"signup":"signin",w=e.signUpMode?o("auth.signUpAction"):o("auth.loginAction"),_=()=>(n==null?void 0:n.value)&&(n==null?void 0:n.value.length)>0&&(n==null?void 0:n.value)===(l==null?void 0:l.value)||o("forms.repeatCorrectlyPassword"),u=P(),U=()=>{e.signUpMode?u.signUp(t.value,l.value):u.signIn(t.value,l.value)},p=g(()=>u.error),L=g(()=>u.isLoading),V=()=>{p.value?a.emit("onSignFailed",p.value):a.emit("onSignSuccessful")};return O(L,(k,M)=>{M&&!k&&V()}),{modeLabel:s,email:t,password:l,passwordRepeat:n,passwordRepeatRule:_,validateButtonLabel:w,onSubmit:U,onReset:()=>{t.value=null,l.value=null,n.value=null}}}},j={class:"flex flex-center"};function x(e,a,o,t,l,n){return f(),h(A,{onSubmit:F(t.onSubmit,["prevent"]),onReset:t.onReset,class:"q-gutter-md"},{default:R(()=>[i(m,{"data-testid":t.modeLabel+"-email-input",filled:"",type:"email",modelValue:t.email,"onUpdate:modelValue":a[0]||(a[0]=s=>t.email=s),label:e.$t("forms.yourEmail"),"lazy-rules":"",rules:[s=>s&&s.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),i(m,{"data-testid":t.modeLabel+"-password-input",filled:"",type:"password",modelValue:t.password,"onUpdate:modelValue":a[1]||(a[1]=s=>t.password=s),label:e.$t("forms.yourPassword"),"lazy-rules":"",rules:[s=>s&&s.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),o.signUpMode?(f(),h(m,{key:0,"data-testid":t.modeLabel+"-passwordrepeat-input",filled:"",type:"password",modelValue:t.passwordRepeat,"onUpdate:modelValue":a[2]||(a[2]=s=>t.passwordRepeat=s),label:e.$t("forms.repeatPassword"),"lazy-rules":"",rules:[t.passwordRepeatRule]},null,8,["data-testid","modelValue","label","rules"])):B("",!0),d("div",j,[i(S,{"data-testid":t.modeLabel+"-okbtn",label:t.validateButtonLabel,type:"submit",color:"primary"},null,8,["data-testid","label"]),i(S,{"data-testid":t.modeLabel+"-resetbtn",label:e.$t("buttons.reset"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["data-testid","label"])])]),_:1},8,["onSubmit","onReset"])}var z=y(Q,[["render",x]]);function D(e){return e!=null&&e.message.toLowerCase().includes("invalid-credential")?c("auth.badLogin"):e!=null&&e.message.toLowerCase().includes("weak-password")?c("auth.weakPassword"):c("auth.technicalError")}function H(e){return console.log(e==null?void 0:e.message),D(e)}const G={components:{SignInputs:z},setup(){const e=I(),{t:a}=v(),o=q();return{handleSignFail:n=>o.NotifyError(H(n)),handleSignOk:()=>{o.NotifySuccess(a("auth.loginOk")),e.push({name:"products"})}}}},J={class:"flex justify-evenly"},K={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},T={class:"text-center"},$={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},W={class:"text-center"};function X(e,a,o,t,l,n){const s=N("sign-inputs");return f(),C("div",J,[d("div",K,[d("h4",T,b(e.$t("auth.loginAction")),1),i(s,{signUpMode:!1,onOnSignFailed:t.handleSignFail,onOnSignSuccessful:t.handleSignOk},null,8,["onOnSignFailed","onOnSignSuccessful"])]),d("div",$,[d("h4",W,b(e.$t("auth.signUpAction")),1),i(s,{signUpMode:!0})])])}var ae=y(G,[["render",X]]);export{ae as default};
