import{_ as y,r,c as p,w as O,H as c,I as g,J as R,j as i,aj as m,K as B,P as d,O as h,b6 as F,N as I,G as N,R as A,M as S}from"./index.84a3eb74.js";import{Q as C,u as q}from"./notify-handler.22fa8327.js";import{u as P}from"./user-store.6dc92048.js";import{u as v}from"./vue-i18n.runtime.6dcd973d.js";import{t as b}from"./index.8b0188d9.js";const Q={name:"SignInputs",props:{signUpMode:{type:Boolean,default:!1}},emits:["onSignSuccessful","onSignFailed"],setup(e,a){const{t:o}=v(),t=r(null),l=r(null),s=r(null),n=e.signUpMode?"signup":"signin",_=e.signUpMode?o("auth.signUpAction"):o("auth.loginAction"),w=()=>(s==null?void 0:s.value)&&(s==null?void 0:s.value.length)>0&&(s==null?void 0:s.value)===(l==null?void 0:l.value)||o("forms.repeatCorrectlyPassword"),u=P(),U=()=>{e.signUpMode?u.signUp(t.value,l.value):u.signIn(t.value,l.value)},f=p(()=>u.error),L=p(()=>u.isLoading),V=()=>{f.value?a.emit("onSignFailed",f.value):a.emit("onSignSuccessful")};return O(L,(k,M)=>{M&&!k&&V()}),{modeLabel:n,email:t,password:l,passwordRepeat:s,passwordRepeatRule:w,validateButtonLabel:_,onSubmit:U,onReset:()=>{t.value=null,l.value=null,s.value=null}}}},j={class:"flex flex-center"};function x(e,a,o,t,l,s){return c(),g(C,{onSubmit:F(t.onSubmit,["prevent"]),onReset:t.onReset,class:"q-gutter-md"},{default:R(()=>[i(m,{"data-testid":t.modeLabel+"-email-input",filled:"",type:"email",modelValue:t.email,"onUpdate:modelValue":a[0]||(a[0]=n=>t.email=n),label:e.$t("forms.yourEmail"),"lazy-rules":"",rules:[n=>n&&n.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),i(m,{"data-testid":t.modeLabel+"-password-input",filled:"",type:"password",modelValue:t.password,"onUpdate:modelValue":a[1]||(a[1]=n=>t.password=n),label:e.$t("forms.yourPassword"),"lazy-rules":"",rules:[n=>n&&n.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),o.signUpMode?(c(),g(m,{key:0,"data-testid":t.modeLabel+"-passwordrepeat-input",filled:"",type:"password",modelValue:t.passwordRepeat,"onUpdate:modelValue":a[2]||(a[2]=n=>t.passwordRepeat=n),label:e.$t("forms.repeatPassword"),"lazy-rules":"",rules:[t.passwordRepeatRule]},null,8,["data-testid","modelValue","label","rules"])):B("",!0),d("div",j,[i(h,{"data-testid":t.modeLabel+"-okbtn",label:t.validateButtonLabel,type:"submit",color:"primary"},null,8,["data-testid","label"]),i(h,{"data-testid":t.modeLabel+"-resetbtn",label:e.$t("buttons.reset"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["data-testid","label"])])]),_:1},8,["onSubmit","onReset"])}var z=y(Q,[["render",x]]);function D(e){return e!=null&&e.message.toLowerCase().includes("invalid-credential")?b("auth.badLogin"):b("auth.technicalError")}function H(e){return console.log(e==null?void 0:e.message),D(e)}const G={components:{SignInputs:z},setup(){const e=I(),{t:a}=v(),o=q();return{handleSignFail:s=>o.NotifyError(H(s)),handleSignOk:()=>{o.NotifySuccess(a("auth.loginOk")),e.push({name:"products"})}}}},J={class:"flex justify-evenly"},K={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},T={class:"text-center"},$={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},W={class:"text-center"};function X(e,a,o,t,l,s){const n=N("sign-inputs");return c(),A("div",J,[d("div",K,[d("h4",T,S(e.$t("auth.loginAction")),1),i(n,{signUpMode:!1,onOnSignFailed:t.handleSignFail,onOnSignSuccessful:t.handleSignOk},null,8,["onOnSignFailed","onOnSignSuccessful"])]),d("div",$,[d("h4",W,S(e.$t("auth.signUpAction")),1),i(n,{signUpMode:!0})])])}var se=y(G,[["render",X]]);export{se as default};
