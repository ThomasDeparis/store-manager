import{_ as k,r as g,O as B,c as h,w as b,H as y,I as w,J as F,j as d,ap as S,K as P,R as r,P as _,bm as x,N as A,bn as I,G as N,S as q,M as U}from"./index.3e052ca9.js";import{Q as C}from"./QForm.f5f883d9.js";import{u as L}from"./vue-i18n.runtime.e96c4d73.js";import{t as m}from"./index.be4ea036.js";import{u as Q}from"./notify-handler.f1c2246c.js";const z={name:"SignInputs",props:{signUpMode:{type:Boolean,default:!1}},emits:["onSignSuccessful","onSignFailed"],setup(t,s){const{t:o}=L(),e=g(null),l=g(null),a=g(null),n=t.signUpMode?"signup":"signin",c=t.signUpMode?o("auth.signUpAction"):o("auth.loginAction"),i=()=>(a==null?void 0:a.value)&&(a==null?void 0:a.value.length)>0&&(a==null?void 0:a.value)===(l==null?void 0:l.value)||o("forms.repeatCorrectlyPassword"),u=B(),V=()=>{t.signUpMode?u.signUp(e.value,l.value):u.signIn(e.value,l.value)},v=h(()=>u.error),M=h(()=>u.isLoading),O=h(()=>u.isAuthenticated),R=()=>{v.value&&s.emit("onSignFailed",v.value)};return b(M,(f,p)=>{p&&!f&&R()}),b(O,(f,p)=>{!p&&f&&s.emit("onSignSuccessful")}),{modeLabel:n,email:e,password:l,passwordRepeat:a,passwordRepeatRule:i,validateButtonLabel:c,onSubmit:V,onReset:()=>{e.value=null,l.value=null,a.value=null}}}},j={class:"flex flex-center"};function D(t,s,o,e,l,a){return y(),w(C,{onSubmit:x(e.onSubmit,["prevent"]),onReset:e.onReset,class:"q-gutter-md"},{default:F(()=>[d(S,{"data-testid":e.modeLabel+"-email-input",filled:"",type:"email",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=n=>e.email=n),label:t.$t("forms.yourEmail"),"lazy-rules":"",rules:[n=>n&&n.length>0||t.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),d(S,{"data-testid":e.modeLabel+"-password-input",filled:"",type:"password",modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=n=>e.password=n),label:t.$t("forms.yourPassword"),"lazy-rules":"",rules:[n=>n&&n.length>0||t.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),o.signUpMode?(y(),w(S,{key:0,"data-testid":e.modeLabel+"-passwordrepeat-input",filled:"",type:"password",modelValue:e.passwordRepeat,"onUpdate:modelValue":s[2]||(s[2]=n=>e.passwordRepeat=n),label:t.$t("forms.repeatPassword"),"lazy-rules":"",rules:[e.passwordRepeatRule]},null,8,["data-testid","modelValue","label","rules"])):P("",!0),r("div",j,[d(_,{"data-testid":e.modeLabel+"-okbtn",label:e.validateButtonLabel,type:"submit",color:"primary"},null,8,["data-testid","label"]),d(_,{"data-testid":e.modeLabel+"-resetbtn",label:t.$t("buttons.reset"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["data-testid","label"])])]),_:1},8,["onSubmit","onReset"])}var H=k(z,[["render",D]]);function G(t){const s=t==null?void 0:t.message.toLowerCase();return s.includes("invalid-credential")?m("auth.badLogin"):s.includes("weak-password")?m("auth.weakPassword"):s.includes("email-already-in-use")?m("auth.emailExists"):m("auth.technicalError")}function J(t){return console.log(t==null?void 0:t.message),G(t)}const K={components:{SignInputs:H},setup(){var c;const t=A(),s=I(),{t:o}=L(),e=Q();let l=(c=s==null?void 0:s.query)==null?void 0:c.nextPage;return b(()=>{var i;return(i=s==null?void 0:s.query)==null?void 0:i.nextPage},i=>{l=i}),{handleSignFail:i=>e.NotifyError(J(i)),handleSignOk:()=>{l?t.push({name:l}):t.push({name:"products"}),e.NotifySuccess(o("auth.loginOk"))}}}},T={class:"flex justify-evenly"},$={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},W={class:"text-center"},X={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},Y={class:"text-center"};function Z(t,s,o,e,l,a){const n=N("sign-inputs");return y(),q("div",T,[r("div",$,[r("h4",W,U(t.$t("auth.loginAction")),1),d(n,{signUpMode:!1,onOnSignFailed:e.handleSignFail,onOnSignSuccessful:e.handleSignOk},null,8,["onOnSignFailed","onOnSignSuccessful"])]),r("div",X,[r("h4",Y,U(t.$t("auth.signUpAction")),1),d(n,{signUpMode:!0})])])}var le=k(K,[["render",Z]]);export{le as default};
