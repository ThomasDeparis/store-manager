import{b4 as C,b5 as t,b6 as I,b7 as b,b8 as f,b9 as p,ba as c,bb as w,bc as T}from"./index.d9beb1c5.js";import{E as m}from"./errortype.28c52496.js";const U=C("customer",{state:()=>({customers:[],isLoading:!1,storeId:""}),actions:{async loadCustomers(s){this.storeId=s,this.customers=[],this.isLoading=!0;const o=t(c,"customers"),n=I(o,b("storeId","==",s)),a=await f(n);this.customers=a.docs.map(function(r){var e,u,h,l,y,g,i;return{id:r.id,name:(e=r.data())==null?void 0:e.name,address:(u=r.data())==null?void 0:u.address,country:(h=r.data())==null?void 0:h.country,email:(l=r.data())==null?void 0:l.email,phone:(y=r.data())==null?void 0:y.phone,storeId:(g=r.data())==null?void 0:g.storeId,lastChangeUserId:(i=r.data())==null?void 0:i.lastChangeUserId}}),this.isLoading=!1},async addCustomer(s){try{const o=p(t(c,"customers"));s.id=o.id,await w(o,s),this.customers.push(s)}catch(o){throw{customerName:s.name,errorType:m.Technical,message:o.toString()}}},async editCustomer(s){try{const o=p(t(c,"customers"),s.id);await T(o,{name:s.name,address:(s==null?void 0:s.address)||null,country:(s==null?void 0:s.country)||null,email:(s==null?void 0:s.email)||null,phone:(s==null?void 0:s.phone)||null,lastChangeUserId:s==null?void 0:s.lastChangeUserId});const n=this.customers.findIndex(r=>r.id===s.id&&r.storeId===s.storeId);if(n<0)throw{customerName:s.id,errorType:m.Technical,message:"customerStore.editCustomer : cannot find customer in store to edit it"};const a=this.customers[n];a.name=s.name,a.address=s.address,a.country=s.country,a.email=s.email,a.phone=s.phone,a.lastChangeUserId=s.lastChangeUserId}catch(o){throw{customerName:s.id,errorType:m.Technical,message:o.toString()}}}}});export{U as u};
