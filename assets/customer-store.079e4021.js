import{ai as C}from"./index.a9029666.js";import{E as t}from"./errortype.7fda15b6.js";import{c,q as I,w as f,g as w,d as p,a as m,s as T,b as E}from"./user-store.735d9c86.js";const D=C("customer",{state:()=>({customers:[],isLoading:!1,storeId:""}),actions:{async loadCustomers(s){this.storeId=s,this.customers=[],this.isLoading=!0;const o=c(m,"customers"),n=I(o,f("storeId","==",s)),a=await w(n);this.customers=a.docs.map(function(r){var e,u,h,l,g,i,y;return{id:r.id,name:(e=r.data())==null?void 0:e.name,address:(u=r.data())==null?void 0:u.address,country:(h=r.data())==null?void 0:h.country,email:(l=r.data())==null?void 0:l.email,phone:(g=r.data())==null?void 0:g.phone,storeId:(i=r.data())==null?void 0:i.storeId,lastChangeUserId:(y=r.data())==null?void 0:y.lastChangeUserId}}),this.isLoading=!1},async addCustomer(s){try{const o=p(c(m,"customers"));s.id=o.id,await T(o,s),this.customers.push(s)}catch(o){throw{customerName:s.name,errorType:t.Technical,message:o.toString()}}},async editCustomer(s){try{const o=p(c(m,"customers"),s.id);console.log(s),await E(o,{name:s.name,address:(s==null?void 0:s.address)||null,country:(s==null?void 0:s.country)||null,email:(s==null?void 0:s.email)||null,phone:(s==null?void 0:s.phone)||null,lastChangeUserId:s==null?void 0:s.lastChangeUserId});const n=this.customers.findIndex(r=>r.id===s.id&&r.storeId===s.storeId);if(n<0)throw{customerName:s.id,errorType:t.Technical,message:"customerStore.editCustomer : cannot find customer in store to edit it"};const a=this.customers[n];a.name=s.name,a.address=s.address,a.country=s.country,a.email=s.email,a.phone=s.phone,a.lastChangeUserId=s.lastChangeUserId}catch(o){throw{customerName:s.id,errorType:t.Technical,message:o.toString()}}}}});export{D as u};
