import{_ as L,r as p,O as B,c as g,w as b,H as y,I as w,J as F,j as d,aj as h,K as P,R as c,P as _,bh as A,N as I,bi as N,G as q,S as x,M as U}from"./index.d9beb1c5.js";import{Q as C}from"./QForm.61e588dd.js";import{u as k}from"./vue-i18n.runtime.3500c6ba.js";import{t as S}from"./index.161d8075.js";import{u as Q}from"./notify-handler.6890384d.js";const j={name:"SignInputs",props:{signUpMode:{type:Boolean,default:!1}},emits:["onSignSuccessful","onSignFailed"],setup(e,s){const{t:o}=k(),t=p(null),l=p(null),a=p(null),n=e.signUpMode?"signup":"signin",m=e.signUpMode?o("auth.signUpAction"):o("auth.loginAction"),i=()=>(a==null?void 0:a.value)&&(a==null?void 0:a.value.length)>0&&(a==null?void 0:a.value)===(l==null?void 0:l.value)||o("forms.repeatCorrectlyPassword"),u=B(),V=()=>{e.signUpMode?u.signUp(t.value,l.value):u.signIn(t.value,l.value)},v=g(()=>u.error),M=g(()=>u.isLoading),O=g(()=>u.isAuthenticated),R=()=>{v.value&&s.emit("onSignFailed",v.value)};return b(M,(r,f)=>{f&&!r&&R()}),b(O,(r,f)=>{!f&&r&&s.emit("onSignSuccessful")}),{modeLabel:n,email:t,password:l,passwordRepeat:a,passwordRepeatRule:i,validateButtonLabel:m,onSubmit:V,onReset:()=>{t.value=null,l.value=null,a.value=null}}}},z={class:"flex flex-center"};function D(e,s,o,t,l,a){return y(),w(C,{onSubmit:A(t.onSubmit,["prevent"]),onReset:t.onReset,class:"q-gutter-md"},{default:F(()=>[d(h,{"data-testid":t.modeLabel+"-email-input",filled:"",type:"email",modelValue:t.email,"onUpdate:modelValue":s[0]||(s[0]=n=>t.email=n),label:e.$t("forms.yourEmail"),"lazy-rules":"",rules:[n=>n&&n.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),d(h,{"data-testid":t.modeLabel+"-password-input",filled:"",type:"password",modelValue:t.password,"onUpdate:modelValue":s[1]||(s[1]=n=>t.password=n),label:e.$t("forms.yourPassword"),"lazy-rules":"",rules:[n=>n&&n.length>0||e.$t("forms.mandatory")]},null,8,["data-testid","modelValue","label","rules"]),o.signUpMode?(y(),w(h,{key:0,"data-testid":t.modeLabel+"-passwordrepeat-input",filled:"",type:"password",modelValue:t.passwordRepeat,"onUpdate:modelValue":s[2]||(s[2]=n=>t.passwordRepeat=n),label:e.$t("forms.repeatPassword"),"lazy-rules":"",rules:[t.passwordRepeatRule]},null,8,["data-testid","modelValue","label","rules"])):P("",!0),c("div",z,[d(_,{"data-testid":t.modeLabel+"-okbtn",label:t.validateButtonLabel,type:"submit",color:"primary"},null,8,["data-testid","label"]),d(_,{"data-testid":t.modeLabel+"-resetbtn",label:e.$t("buttons.reset"),type:"reset",color:"primary",flat:"",class:"q-ml-sm"},null,8,["data-testid","label"])])]),_:1},8,["onSubmit","onReset"])}var H=L(j,[["render",D]]);function G(e){return e!=null&&e.message.toLowerCase().includes("invalid-credential")?S("auth.badLogin"):e!=null&&e.message.toLowerCase().includes("weak-password")?S("auth.weakPassword"):S("auth.technicalError")}function J(e){return console.log(e==null?void 0:e.message),G(e)}const K={components:{SignInputs:H},setup(){var m;const e=I(),s=N(),{t:o}=k(),t=Q();let l=(m=s==null?void 0:s.query)==null?void 0:m.nextPage;return b(()=>{var i;return(i=s==null?void 0:s.query)==null?void 0:i.nextPage},i=>{l=i}),{handleSignFail:i=>t.NotifyError(J(i)),handleSignOk:()=>{l?e.push({name:l}):e.push({name:"products"}),t.NotifySuccess(o("auth.loginOk"))}}}},T={class:"flex justify-evenly"},$={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},W={class:"text-center"},X={class:"q-pa-md",style:{"min-width":"30%","max-width":"70%"}},Y={class:"text-center"};function Z(e,s,o,t,l,a){const n=q("sign-inputs");return y(),x("div",T,[c("div",$,[c("h4",W,U(e.$t("auth.loginAction")),1),d(n,{signUpMode:!1,onOnSignFailed:t.handleSignFail,onOnSignSuccessful:t.handleSignOk},null,8,["onOnSignFailed","onOnSignSuccessful"])]),c("div",X,[c("h4",Y,U(e.$t("auth.signUpAction")),1),d(n,{signUpMode:!0})])])}var le=L(K,[["render",Z]]);export{le as default};
